<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Sync Manager Tests</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #fff;
            min-height: 100vh;
        }
        
        h1 {
            text-align: center;
            color: #e94560;
            margin-bottom: 30px;
        }
        
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .test-section h2 {
            color: #0f3460;
            border-bottom: 2px solid #e94560;
            padding-bottom: 10px;
        }
        
        .test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        
        .test-btn {
            background: linear-gradient(135deg, #e94560 0%, #0f3460 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(233, 69, 96, 0.4);
        }
        
        .test-btn:active {
            transform: translateY(0);
        }
        
        .test-results {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .test-result-item {
            padding: 10px;
            margin: 5px 0;
            border-radius: 3px;
        }
        
        .test-result-item.pass {
            background: rgba(46, 204, 113, 0.2);
            border-left: 3px solid #2ecc71;
        }
        
        .test-result-item.fail {
            background: rgba(231, 76, 60, 0.2);
            border-left: 3px solid #e74c3c;
        }
        
        .summary {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .summary-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 8px;
            text-align: center;
        }
        
        .summary-item .value {
            font-size: 36px;
            font-weight: bold;
        }
        
        .summary-item .label {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .pass .value {
            color: #2ecc71;
        }
        
        .fail .value {
            color: #e74c3c;
        }
        
        .total .value {
            color: #3498db;
        }
        
        #console-output {
            background: #1a1a2e;
            border: 1px solid #333;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .console-line {
            margin: 2px 0;
        }
        
        .console-line.pass {
            color: #2ecc71;
        }
        
        .console-line.fail {
            color: #e74c3c;
        }
        
        .console-line.info {
            color: #3498db;
        }
    </style>
</head>
<body>
    <h1>üèÄ Data Sync Manager Tests</h1>
    
    <div class="test-section">
        <h2>Test Controls</h2>
        <div class="test-buttons">
            <button class="test-btn" onclick="runUnitTests()">Run Unit Tests</button>
            <button class="test-btn" onclick="runIntegrationTests()">Run Integration Tests</button>
            <button class="test-btn" onclick="runAllTests()">Run All Tests</button>
            <button class="test-btn" onclick="clearResults()">Clear Results</button>
        </div>
        
        <div class="summary" id="test-summary" style="display: none;">
            <div class="summary-item pass">
                <div class="value" id="passed-count">0</div>
                <div class="label">Passed</div>
            </div>
            <div class="summary-item fail">
                <div class="value" id="failed-count">0</div>
                <div class="label">Failed</div>
            </div>
            <div class="summary-item total">
                <div class="value" id="total-count">0</div>
                <div class="label">Total</div>
            </div>
        </div>
        
        <div class="test-results" id="test-results"></div>
    </div>
    
    <div class="test-section">
        <h2>Console Output</h2>
        <div id="console-output"></div>
    </div>
    
    <script src="../configs/scholarshipConfig.js"></script>
    <script src="../data/gameData.js"></script>
    <script src="../modules/dataModels.js"></script>
    <script src="../modules/gameStateManager.js"></script>
    <script src="../modules/dataSyncManager.js"></script>
    <script src="dataSyncManager.unit.tests.js"></script>
    <script src="dataSyncManager.integration.tests.js"></script>
    
    <script>
        const consoleOutput = document.getElementById('console-output');
        const testResultsDiv = document.getElementById('test-results');
        const summaryDiv = document.getElementById('test-summary');
        
        function logToConsole(message, type = 'info') {
            const line = document.createElement('div');
            line.className = `console-line ${type}`;
            line.textContent = message;
            consoleOutput.appendChild(line);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        function clearConsole() {
            consoleOutput.innerHTML = '';
        }
        
        function clearResults() {
            testResultsDiv.innerHTML = '';
            summaryDiv.style.display = 'none';
            clearConsole();
            logToConsole('Results cleared', 'info');
        }
        
        function displayResults(results, testType) {
            testResultsDiv.innerHTML = '';
            summaryDiv.style.display = 'flex';
            
            document.getElementById('passed-count').textContent = results.passed;
            document.getElementById('failed-count').textContent = results.failed;
            document.getElementById('total-count').textContent = results.tests.length;
            
            results.tests.forEach(test => {
                const item = document.createElement('div');
                item.className = `test-result-item ${test.passed ? 'pass' : 'fail'}`;
                item.textContent = `${test.passed ? '‚úÖ' : '‚ùå'} ${test.name}`;
                if (!test.passed && test.error) {
                    item.textContent += `: ${test.error}`;
                }
                testResultsDiv.appendChild(item);
            });
            
            logToConsole(`${testType}: ${results.passed} passed, ${results.failed} failed`, 
                        results.failed > 0 ? 'fail' : 'pass');
        }
        
        function runUnitTests() {
            logToConsole('Running Unit Tests...', 'info');
            clearConsole();
            
            const tests = new DataSyncManagerTests();
            const results = tests.runAllTests();
            displayResults(results, 'Unit Tests');
        }
        
        function runIntegrationTests() {
            logToConsole('Running Integration Tests...', 'info');
            clearConsole();
            
            const tests = new DataSyncManagerIntegrationTests();
            const results = tests.runAllTests();
            displayResults(results, 'Integration Tests');
        }
        
        function runAllTests() {
            logToConsole('Running All Tests...', 'info');
            clearConsole();
            
            const unitTests = new DataSyncManagerTests();
            const unitResults = unitTests.runAllTests();
            
            const integrationTests = new DataSyncManagerIntegrationTests();
            const integrationResults = integrationTests.runAllTests();
            
            const combinedResults = {
                passed: unitResults.passed + integrationResults.passed,
                failed: unitResults.failed + integrationResults.failed,
                tests: [...unitResults.tests, ...integrationResults.tests]
            };
            
            displayResults(combinedResults, 'All Tests');
        }
        
        logToConsole('Test runner initialized. Click a button to run tests.', 'info');
    </script>
</body>
</html>
